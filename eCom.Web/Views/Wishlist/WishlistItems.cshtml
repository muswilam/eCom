@model WishlistViewModel

@{
    var defaultImgUrl = "/Content/Images/default.jpg";
}

@if (Model != null && Model.Wishlist != null && Model.Wishlist.WishlistItems.Count() > 0)
{
<div class="product-content product-threecolumn product-slidebar clearfix">
    <div class="text-center mb-4">
        <button type="button" class="btn btn-danger" id="emptyWishlistBtn">Empty Wishlist</button>
    </div>
    <ul class="product style2 sd1">
        @foreach (var wishItem in Model.Wishlist.WishlistItems)
        {
            var imageUrl = string.IsNullOrEmpty(wishItem.Product.ImageUrl) ? defaultImgUrl : wishItem.Product.ImageUrl;

            <li class="product-item">
                <div class="product-thumb clearfix">
                    <a href="@Url.Action("Details","Product", new { id = wishItem.ProductId})">
                        <img src="@imageUrl" alt="image" class="img-thumbnail" style="height:250px;">
                    </a>
                </div>
                <div class="product-info clearfix mt-2">
                    <span class="product-title">@wishItem.Product.Name</span>
                    <div class="price">
                        <ins>
                            <span class="amount">$@wishItem.Product.Price</span>
                        </ins>
                    </div>
                </div>
                @if (User.Identity.IsAuthenticated)
                {
                    <div class="add-to-cart text-center">
                        <a class="productAddToCart" data-id="@wishItem.ProductId">ADD TO CART</a>
                    </div>
                }
                @*<a href="#" class="like"><i class="fa fa-heart-o"></i></a>*@
            </li>

        }
    </ul><!-- /.product -->
</div><!-- /.product-content -->


    <script>
        //remoe all item of wishlist
        $("#emptyWishlistBtn").click(function () {
            swal({
                title: "Confirm!",
                text: "Are you sure? wanna empty wishlist.",
                icon: "warning",
                buttons: true,
                dangerMode: true,
            })
            .then(function (willDelete) {
                if (willDelete) {
                    $.ajax({
                        url: '@Url.Action("EmptyWishlist","Wishlist")',
                    })
                     .done(function (result) {
                         if (result.success) {
                             swal("Done", "Wishlist has been empty successfuly.", {
                                 icon: "success",
                             }).then(function () {
                                 window.location = '@Url.Action("Index","Shop")';
                             })
                         } else {
                             swal("Failed", result.message, {
                                 icon: "warning",
                             });
                         };
                     })
                     .fail(function () {
                         alert("Fail");
                     })
                }
            });
        })
    </script>
}
else
{
    <div class="alert alert-danger">
        No products in your wishlist yet.
    </div>
}
